{{if loading}}
    <mx-loading height="100px" style="transform: scale(0.5);"/>
{{else}}
    <!-- 搜索框 -->
    {{if searchbox}}
    <div class="mx-output-search">
        <mx-input 
            style="{{if over}} width: 200px; {{else}} width: 100%; {{/if}}"
            prefix="search"
            placeholder="{{=text.search}}"
            value="{{=keyword}}"
            mx-change="@{search}()"
            {{if spm}} data-spm-click="{{=spm}}_s" {{/if}}/>
    </div>
    {{/if}}

    {{if (allHide || count == 0)}}
        {{if over}}
        <mx-error type="empty-content" mode="small" tip="{{=text.empty}}"/>
        {{else}}
        <div class="mx-output-empty">{{=text.empty}}</div>
        {{/if}}
    {{else}}
        {{if multiple}} 
            {{if (needAll || max > 0)}} 
            <div class="oper-wrapper clearfix">
                {{if needAll}}
                <mx-checkbox class="fl custom-checkbox" 
                    style="width: auto;"
                    checked="{{=(type == 3)}}"
                    indeterminate="{{=(type == 2)}}"
                    value="{{=viewId}}_all"
                    text="{{=text.select}}"
                    mx-focusout="@{stop}()"
                    mx-change="@{checkParent}({parentIndex:'all'})"
                    {{if spm}} data-spm-click="{{=spm}}_all_{{=parent.value}}" {{/if}}/>
                {{/if}}
                {{if (max > 0)}}
                <span class="fr">
                    <span class="color-9">已选：</span>
                    <span class="font-number">{{=selectedItems.length}}<span class="color-9">&nbsp;/&nbsp;{{=max}}</span></span>
                </span>
                {{/if}}
            </div>
            {{/if}}
            <div style="{{if height}} max-height:{{=height}}px; {{/if}}" class="mx-output-list" >
                {{each parents as parent parentIndex}}
                    {{if !parent.hide}}
                        {{if (hasGroups && parent.text)}}
                            {{if needGroup}}
                            <div class="clearfix">
                                <div class="mx-output-item dropdown-group-item" title="{{=(parent.tip || parent.text)}}">
                                    <div class="mx-output-link {{if (parent.disabled || ((max > 0) && (selectedItems.length >= max)))}} mx-output-link-disabled {{/if}}">
                                        <mx-checkbox class="custom-checkbox"
                                            disabled="{{=(parent.disabled || ((max > 0) && (selectedItems.length >= max)))}}"
                                            checked="{{=(parent.type == 3)}}"
                                            indeterminate="{{=(parent.type == 2)}}"
                                            value="{{=parent.value}}"
                                            text="{{=parent.text}}"
                                            mx-focusout="@{stop}()"
                                            mx-change="@{checkParent}({parentIndex:'{{=parentIndex}}'})"
                                            {{if spm}} data-spm-click="{{=spm}}{{=parent.value}}" {{/if}}/>
                                    </div>
                                </div>
                            </div>
                            {{else}}
                            <div class="mx-output-header" title="{{=(parent.tip || parent.text)}}">{{!parent.text}}</div>
                            {{/if}}
                        {{/if}}
                        <div class="clearfix dropdown-group-wrapper">
                            {{each parent.list as item itemIndex}}
                                {{if !item.hide}}
                                <div class="mx-output-item dropdown-group-item" title="{{=(item.tip || item.text)}}">
                                    {{if (item.disabled && item.disabledTip)}}
                                    <mx-popover class="mx-output-link {{if item.disabled}} mx-output-link-disabled {{/if}}"
                                        content="&lt;div style='display: inline-flex; align-items: center;'&gt;&lt;i class='mc-iconfont color-red'&gt;&#38;&#35;xe6ad;&lt;/i&gt;&nbsp;{{=item.disabledTip}}&lt;/div&gt;"
                                        placement="right" offset="{{@{left:-10}}}">
                                        <mx-checkbox 
                                            value="{{=item.value}}"
                                            text="{{=item.text}}"
                                            checked="{{=item.selected}}"
                                            disabled="true"/>
                                    </mx-popover>
                                    {{else}}
                                    <div class="mx-output-link {{if (item.disabled || (!item.selected && (max > 0) && (selectedItems.length >= max)))}} mx-output-link-disabled {{/if}}">
                                        <mx-checkbox class="custom-checkbox"
                                            checked="{{=item.selected}}"
                                            disabled="{{=(item.disabled || (!item.selected && (max > 0) && (selectedItems.length >= max)))}}"
                                            value="{{=item.value}}"
                                            text="{{=item.text}}"
                                            mx-focusout="@{stop}()"
                                            mx-change="@{check}({parentIndex:'{{=parentIndex}}',itemIndex:'{{=itemIndex}}'})"
                                            {{if spm}} data-spm-click="{{=spm}}{{=item.value}}" {{/if}}/>
                                    </div>
                                    {{/if}}
                                </div>  
                                {{/if}}
                            {{/each}}
                        </div>
                    {{/if}}
                {{/each}}
            </div>
            <div class="multiple-footer">
                {{if tip}}
                <div class="multiple-footer-tip">{{!tip}}</div>
                {{/if}}
                <div class="multiple-footer-content clearfix">
                    <div class="fl nowrap clearfix">
                        <mx-btn mode="primary" size="small" mx-click="@{submit}()" content="{{=text.submit}}"/>
                        <mx-btn class="ml10" size="small" mx-click="@{cancel}()" content="{{=text.cancel}}"/>
                    </div>
                    {{if errMsg}}
                    <span class="fl ml10 footer-error"><i class="mc-iconfont">&#xe727;</i>&nbsp;{{!errMsg}}</span>
                    {{/if}}
                </div>
            </div>
        {{else}}
            <div class="mx-output-list" style="{{if height}} max-height:{{=height}}px; {{/if}}">
                {{each parents as parent parentIndex}}
                    {{if !parent.hide}}
                        {{if (hasGroups && parent.text)}}
                        <div class="mx-output-header" title="{{=parent.text}}">{{!parent.text}}</div>
                        {{/if}}
                        {{each parent.list as item itemIndex}}
                            {{if !item.hide}}
                            <div class="mx-output-item" title="{{=(item.tip || item.text)}}">
                                {{if (item.disabled && item.disabledTip)}}
                                    <mx-popover class="mx-output-link mx-output-link-disabled"
                                        content="&lt;div style='display: inline-flex; align-items: center;'&gt;&lt;i class='mc-iconfont color-red'&gt;&#38;&#35;xe6ad;&lt;/i&gt;&nbsp;{{=item.disabledTip}}&lt;/div&gt;"
                                        placement="right" offset="{{@{left:-10}}}">{{!item.text}}</mx-popover>
                                {{else}}
                                    <span class="mx-output-link {{if item.selected}} mx-output-link-active {{/if}} {{if item.disabled}} mx-output-link-disabled {{/if}}" 
                                        {{if !item.disabled}} mx-click="@{select}({item:'{{@item}}'})" {{if spm}} data-spm-click="{{=spm}}{{=item.value}}" {{/if}} {{/if}}>
                                        {{!item.text}}
                                        {{if (item.opers && item.opers.length)}}
                                        <span class="link-opers">
                                            {{each item.opers as oper}}
                                                {{if oper == 'delete'}}
                                                <i class="link-oper mc-iconfont" title="移除" mx-click="@{delete}({item:'{{@item}}'})">&#xe68d;</i>
                                                {{/if}}
                                                {{if oper == 'edit'}}
                                                <i class="link-oper mc-iconfont" title="编辑" mx-click="@{select}({item:'{{@item}}',operationType:'edit'})">&#xe698;</i>
                                                {{/if}}
                                            {{/each}}
                                        </span>
                                        {{/if}}
                                    </span>
                                {{/if}}
                            </div>  
                            {{/if}}
                        {{/each}}
                    {{/if}}
                {{/each}}
            </div>
            {{if tip}}
            <div class="mx-output-footer">{{!tip}}</div>
            {{/if}}
        {{/if}}
    {{/if}}
{{/if}}
